!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("wafer-tooltip",[],e):"object"==typeof exports?exports["wafer-tooltip"]=e():(t.wafer=t.wafer||{},t.wafer.wafers=t.wafer.wafers||{},t.wafer.wafers["wafer-tooltip"]=e())}("undefined"!=typeof self?self:this,function(){return function(t){function e(i){if(o[i])return o[i].exports;var r=o[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var o={};return e.m=t,e.c=o,e.d=function(t,o,i){e.o(t,o)||Object.defineProperty(t,o,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(o,"a",o),o},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="https://s.yimg.com/aaq/wf/",e(e.s="./src/entry.js")}({"./src/base.js":function(t,e,o){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){var o=[],i=!0,r=!1,s=void 0;try{for(var a,n=t[Symbol.iterator]();!(i=(a=n.next()).done)&&(o.push(a.value),!e||o.length!==e);i=!0);}catch(t){r=!0,s=t}finally{try{!i&&n.return&&n.return()}finally{if(r)throw s}}return o}return function(e,o){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,o);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}(),a=window.wafer,n=a.constants,l=a.features,u=a.utils,c=n.ATTR_PREFIX,f=n.DISPLAY_BLOCK,d=n.DISPLAY_NONE,p=n.WAFER_DESTROYED,h="has-tooltip-click",y="wafer-tooltip",v="wafer-tooltip-wrapper",w="wafer-tooltip-text",g="wafer-tooltip-close",b=u.convertNodeListToArray,_=["handleTooltipClose"],m=1,E=0,S=3,T=[200,0],C=15,D="wafer-tooltip-template",O="top",k="",L="viewport",j=function(){function t(e){var o=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=s.selector,n=s.successClass;i(this,t),this._util={elem:e,selector:a.replace(".","")};var l=e.getAttribute(c+"local-storage-key");if(!l)return void this.teardown(c+"local-storage-key data attribute is mandatory for element with "+y+" class");var u=e.getAttribute(c+"max-display-count")||S,f=e.getAttribute(c+"reset-every")||C,p=e.getAttribute(c+"template-id")||D,j=e.getAttribute(c+"display-delay")||E,x=e.getAttribute(c+"tooltip-position")||O,A=e.getAttribute(c+"tooltip-text")||k,P=e.getAttribute(c+"trigger")||L,R=e.getAttribute(c+"trigger-offset"),I=R&&R.split(" ")||T,W=r(I,2),N=W[0],B=W[1],Y=e.getAttribute(c+"tooltip-discovered-count")||m;this._util.localStorageKey=l,this._util.maxDisplayCount=u,this._util.resetEvery=f,this._util.discoveredCount=Y;var M=this.getPreviousLocalState;if(this.isResetEveryExceeded(M.lastResetDate)&&this.refreshLastResetDate(),!this.isEligibleToShow)return void this.teardown("Tooltip is not eligible to be shown.");var X=document.getElementById(p);if(!X)return void this.teardown("Cannot find a template with id "+p);if(e.appendChild(X.content.cloneNode(!0)),"top"!==x&&"bottom"!==x)return void this.teardown(c+"tooltip-position must be 'top' or 'bottom'");var F=b(e.getElementsByClassName(v));if(!F.length)return void this.teardown("Cannot find an element with class "+v);var K=F[0];K.setAttribute("data-toolpos",x),K.style.display=d,this._util.divWrapper=K;var V=b(e.getElementsByClassName(w));if(!V.length)return void this.teardown("Cannot find an element with class "+w);V[0].innerHTML=A,this._util.closeButtonElms=b(e.getElementsByClassName(g)),e.classList.contains(g)&&this._util.closeButtonElms.push(e),this._util.closeButtonElms.length&&e.classList.add(h),e.classList.add(n),this._util.offsetX=Number(B),this._util.offsetY=Number(N),this._util.tooltipDisplayDelay=j,this._util.trigger=P,_.forEach(function(t){o[t]=o[t].bind(o)}),window.wafer.base.sync(e)}return s(t,[{key:"teardown",value:function(t){this._util.elem&&this._util.elem.classList.add(p),window.wafer.base.destroy(this._util.elem)}},{key:"destroy",value:function(){var t=this._util.elem;t&&t.classList.add(p),this._util={}}},{key:"showTooltip",value:function(){var t=this,e=this._util,o=e.divWrapper,i=e.tooltipDisplayDelay;if(this.isEligibleToShow&&o&&!this.isTooltipAlreadyVisible){this._util.timeoutId=setTimeout(function(){t._util.timeoutId=void 0,o.style.display=f},i);var r=this.getPreviousLocalState;r.lastDisplayCount++,this.writeToLocalStorage=r}}},{key:"hideTooltip",value:function(){var t=this._util.divWrapper;t&&(t.style.display=d)}},{key:"daysDifference",value:function(t,e){return Math.floor((e-t)/864e5)}},{key:"isResetEveryExceeded",value:function(t){var e=this._util.resetEvery,o=Date.now();return this.daysDifference(t,o)>=e}},{key:"refreshLastResetDate",value:function(){var t=this.getPreviousLocalState;t.lastResetDate=Date.now(),t.lastDisplayCount=0,t.discovered=0,this.writeToLocalStorage=t}},{key:"handleTooltipClose",value:function(t){var e=t.target;if(-1!==this._util.closeButtonElms.indexOf(e)){this._util.divWrapper&&(this._util.divWrapper.style.display=d);var o=this.getPreviousLocalState;o.discovered++,this.writeToLocalStorage=o}}},{key:"config",get:function(){return{offsetX:this._util.offsetX,offsetY:this._util.offsetY,trigger:this._util.trigger}}},{key:"isTooltipAlreadyVisible",get:function(){var t=this._util,e=t.divWrapper,o=t.timeoutId;return e&&e.style.display===f||void 0!==o}},{key:"readFromLocalStorage",get:function(){var t=this._util.localStorageKey,e={};if(l.localStorage)try{e=JSON.parse(window.localStorage.getItem(t))||{}}catch(t){}return e}},{key:"writeToLocalStorage",set:function(t){var e=this._util.localStorageKey;if(l.localStorage)try{window.localStorage.setItem(e,JSON.stringify(t))}catch(t){}}},{key:"getPreviousLocalState",get:function(){var t=this.readFromLocalStorage;return t.discovered=t.discovered||0,t.lastResetDate=t.lastResetDate||Date.now(),t.lastDisplayCount=t.lastDisplayCount||0,t}},{key:"isEligibleToShow",get:function(){var t=this._util,e=t.discoveredCount,o=t.maxDisplayCount,i=this.getPreviousLocalState,r=i.discovered,s=i.lastDisplayCount,a=i.lastResetDate;return!(r>=e||!this.isResetEveryExceeded(a)&&s>=o)}}]),t}();j.events={click:[["has-tooltip-click","handleTooltipClose"]]},e.default=j,t.exports=e.default},"./src/controller.js":function(t,e,o){"use strict";function i(){return l=r(o("./src/base.js"))}function r(t){return t&&t.__esModule?t:{default:t}}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var l,u=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(t[i]=o[i])}return t},c=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}(),f=window.wafer.utils,d=f.elementInView,p=f.throttle,h=window.wafer.base,y=window.wafer.controllers.WaferBaseController,v=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=t.root,r=void 0===o?document:o;s(this,e);var n=e.prototype.configs,c=n.selector,f=n.successClass,d=n.validateDelay,h=void 0===d?25:d,y=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,{root:r,selector:c,props:{selector:c,successClass:f},WaferClass:(l||i()).default}));return y._options=u({},y._options,{defaultOffsetY:200,defaultOffsetX:0}),y._validateWithThrottle=p(function(){y.validate()},h,y),y.sync(),y}return n(e,t),c(e,[{key:"handleScroll",value:function(){this._validateWithThrottle()}},{key:"handleResize",value:function(){this._validateWithThrottle()}},{key:"willValidate",value:function(t){var e=this._state.elementInstances;t.forEach(function(t){var o=e.get(t),i=o.instance,r=i.config,s=r.trigger,a=r.offsetX,n=r.offsetY;switch(s){case"onLoad":i.renderTooltip();break;case"viewport":default:d(t,{offsetX:a,offsetY:n},h.viewport)?i.showTooltip():i.hideTooltip()}})}}]),e}(y);v.prototype.configs={selector:".wafer-tooltip",successClass:"wafer-tooltip-done"},e.default=v,t.exports=e.default},"./src/entry.js":function(t,e,o){"use strict";function i(){return s=r(o("./src/controller.js"))}function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var s;e.default=new((s||i()).default)({selector:(s||i()).default.prototype.configs.selector}),t.exports=e.default}})});